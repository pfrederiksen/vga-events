name: Workflow Keep-Alive

on:
  schedule:
    # Run every 50 days to prevent GitHub from auto-disabling workflows
    # (GitHub disables scheduled workflows after 60 days of repository inactivity)
    - cron: '0 0 */50 * *'
  workflow_dispatch:  # Allow manual trigger

permissions:
  actions: write
  contents: read

jobs:
  keep-alive:
    runs-on: ubuntu-latest

    steps:
      - name: Keep workflows alive
        run: |
          echo "✅ Keep-alive ping"
          echo "This workflow prevents GitHub from auto-disabling scheduled workflows."
          echo "GitHub disables workflows after 60 days of repository inactivity."
          echo "Running this every 50 days ensures workflows stay active."

      - name: Trigger a manual workflow run
        uses: actions/github-script@v7
        with:
          script: |
            // Trigger the telegram bot workflow to ensure it stays active
            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'telegram-bot.yml',
              ref: 'main'
            });
            console.log('✅ Triggered telegram-bot workflow');
